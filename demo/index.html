<!doctype html>
<html>
    <head>
        <title>gfs-carrier-info demo</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
        <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

        <link rel="import" href="../../iron-demo-helpers/demo-pages-shared-styles.html">
        <link rel="import" href="../../iron-demo-helpers/demo-snippet.html">

        <!-- <link rel="import" href="../../gfs-checkout-widget/gfs-checkout-widget.html"> -->
        <link rel="import" href="../gfs-checkout-widget.html">

        <style is="custom-style" include="demo-pages-shared-styles">
        </style>

    </head>
    <body>

        <div class="vertical-section-container centered">
            <h3>Basic gfs-checkout-widget Demo</h3>
            <dom-module id="data-handler">
                <template>
                    <template is="dom-if" if="{{run}}">
                        <form method="post">
                            <div id="handler">
                                <input type="hidden" name="checkoutResult" id="checkoutResult" />
                                <input type="hidden" name="sessionID" id="sessionID" />

                                <gfs-checkout id="gfs-checkout-widget" checkout-results="checkoutResult" sessionid="sessionID"
                                              access-token="ZXlKMGVYQWlPaUpLVjFRaUxDSmhiR2NpT2lKU1V6STFOaUlzSW5nMWRDSTZJa1pXWmtObFJGSlNaa2RHWkRCWVFuWlBTbXBZWDJ0eE5qRlNSU0lzSW10cFpDSTZJa1pXWmtObFJGSlNaa2RHWkRCWVFuWlBTbXBZWDJ0eE5qRlNSU0o5LmV5SnBjM01pT2lKb2RIUndjem92TDJsa1pXNTBhWFI1TG1wMWMzUnphRzkxZEdkbWN5NWpiMjBpTENKaGRXUWlPaUpvZEhSd2N6b3ZMMmxrWlc1MGFYUjVMbXAxYzNSemFHOTFkR2RtY3k1amIyMHZjbVZ6YjNWeVkyVnpJaXdpWlhod0lqb3hOVGM1T0RJMU16QXdMQ0p1WW1ZaU9qRTBOems0TWpVek1ERXNJbU5zYVdWdWRGOXBaQ0k2SW1GdFltbDBhVzkxYzE5aGJHbGpaU0lzSW1SbGRpMWhjR2t0YTJWNUlqb2lRMHd0TkVORk9USTJNVE10T0RsQk5pMDBNalE0TFVFMU56TXRRVGxCTnpNek0wVTJRVEEySWl3aWRHVnpkQzFoY0drdGEyVjVJam9pUTB3dE5EVXdNRVpETVVFdE4wUkROQzAwTjBGQ0xVRkZPVEl0UlRFME1qWkZNVEU1TVRsQ0lpd2liR2wyWlMxaGNHa3RhMlY1SWpvaVEwd3RORU5GT1RJMk1UTXRPRGxCTmkwME1qUTRMVUUxTnpNdFFUbEJOek16TTBVMlFUQTJJaXdpYzJOdmNHVWlPbHNpWTJobFkydHZkWFF0WVhCcElpd2ljbVZoWkNKZGZRLko0SGw4di1BZ21WRFcwNTRaX0hYTG9WVUlRLWN3b3FpeWxRcllfYlNUNzd6LW8xQ3dnaWhxVzI3Qk5ITHNIazhhQ1RhSkNQZ213c3VKYkR1LVpWcTlrdF9zbTFZOFpYZW9VQXVoT0l6dXpFb2VWUWxLNDZJTWF6bEEwcVp5bHhqWFdId3VuenJmNUEwYjFmeHZWQkhQVE91RTJnTUVhU0FvTF84ajh6REZsUnZLTHNncFFVUFEzSTlYMGZMZnF5eUlPQnlHYlViRWF1ajFGVS1yN3Q1NmZNVkFsM0FSZEhJNi1yM0d6azN4cUhPVUlrTnpBZU9JX2tEcnFMV1kzRUNNdEg5d1lmNDZEbjhhdlctN1F1NmJoMjl0eFhHQWZXWU45blY3bW5HeG9uZ3Vqcy1sSDRUdFZ0SWQyQ3JiSDVvT2hPRXQ0VlZrMVg3NmwzM1VBQmYwbHl3MmJWSHowZlNWR1doSjRxbkl2WmFHQmdMSzd6MERvWEcwV2F5Y3lZNnRkV0NpbDJEdUVOLUZCQXJ2NXR1dXJ0WVRRVF81YUo0T3BtWHo0WEQtVEZHOE1tM2h6UWU5UDZVSVgxYVJkSWpKN0xnTzBaQVQ5ZFFiU2hPX19jZlI2YU9EZjJGR1VSUVhvRVZUclo4cEtLR3Y4X1NXVURSMGZkSmlvejNKc1ctSVMzTTRieEdFa2g3ZlNrWG1Va0pkOXZ1WURYRXZSYklvRXhTYXA0MHJhSHE5Y01BcEdrOTBVSEtYUHZvYUZSV09WSHhCM1BLY2dZNkYxaEI0Q09qRlBCVGExOXpnaHduT0REYjJGSnBwQ3VIYnJDQUFyeVl2LUdXLTdEcU5CTWR1NWpidWtrdS1RMEZZLW0yemxraG8taGsyMnFmMTlJZjF2aUFGWXQ0clE0"
                                              gfs-data="{{requestData}}"
                                              initial-address="100 Station Road, Horsham, RH13 5UZ, United Kingdom"
                                              currency-symbol="&pound;"
                                              service-sort-order="cheapestFirst"
                                              default-delivery="Standard"
                                              default-service="Standard"
                                              default-carrier="YODEL"
                                              default-carrier-code="ECO"
                                              default-price="2.50"
                                              default-min-delivery-time="1"
                                              default-max-delivery-time="5">
                                </gfs-checkout>
                            </div>
                        </form>
                    </template>
                </template>

                <script>
                    addEventListener('WebComponentsReady', function() {
                        Polymer({
                            is: "data-handler",

                            properties: {
                                requestData: {
                                    type: String,
                                    notify: true,
                                    reflectToAttribute: true,
                                },

                                run: {
                                    type: Boolean
                                }
                            },

                            ready: function() {
                                this.run = false;
                                var DateFrom = moment().format('YYYY-MM-DD');
                                var DateTo = moment().add(14, 'days').format('YYYY-MM-DD');
                                var json = "eyJSZXF1ZXN0Ijp7IkRhdGVSYW5nZSI6eyJEYXRlRnJvbSI6IjIwMTYtMTItMDkiLCJEYXRlVG8iOiIyMDE2LTEyLTIzIn0sIk9yZGVyIjp7IlRyYW5zaXQiOnsiUmVjaXBpZW50Ijp7IkNvbnRhY3REZXRhaWxzIjp7IkVtYWlsIjoiZ3Vlc3RAZ3Vlc3QuY29tIn0sIkxvY2F0aW9uIjp7IkFkZHJlc3NMaW5lQ29sbGVjdGlvbiI6WyIxMDAgU3RhdGlvbiBSb2FkIl0sIkNvdW50cnlDb2RlIjp7IkNvZGUiOiJHQiIsIkVuY29kaW5nIjoiY2NJU09fMzE2Nl8xX0FscGhhMiJ9LCJQb3N0Y29kZSI6IlJIMTMgNVVaIiwiVG93biI6IkhvcnNoYW0ifSwiUGVyc29uIjp7IkZpcnN0TmFtZSI6IkEiLCJMYXN0TmFtZSI6IkN1c3RvbWVyIiwiVGl0bGUiOiJNUiJ9fX0sIlZhbHVlIjp7IkN1cnJlbmN5Q29kZSI6IkdCUCIsIlZhbHVlIjo0NS45OX19LCJSZXF1ZXN0ZWREZWxpdmVyeVR5cGVzIjpbImRtRHJvcFBvaW50IiwiZG1TdGFuZGFyZCJdLCJTZXNzaW9uIjp7IkFQSUtleUlkIjoiQ0wtNENFOTI2MTMtODlBNi00MjQ4LUE1NzMtQTlBNzMzM0U2QTA2In19fQ==";
                                var request = JSON.parse(atob(json));
                                    request.Request.DateRange.DateFrom = DateFrom;
                                    request.Request.DateRange.DateTo = DateTo;
                                var gfsData = btoa(JSON.stringify(request));
                                var homePostcode = request.Request.Order.Transit.Recipient.Location.Postcode;

                                this.set("requestData", gfsData)
                                this.run = true;
                            }
                        });
                    });
                </script>
            </dom-module>

            <data-handler></data-handler>
        </div>

    </body>
</html>
